import matplotlib.pyplot as plt
import numpy as np

def meanFilter(curve,radius):
    #padding
    curvePad = np.zeros(shape=(len(curve) + 2 * radius))
    curveRes = np.zeros_like(curve)
    for i in range(0,radius):
        curvePad[i] = curve[i]

    for i in range(radius,len(curvePad) - radius):
        curvePad[i] = curve[i - radius]
    
    for i in range(len(curvePad) - radius,len(curvePad)):
        curvePad[i] = curve[i - 2*radius]    
    #filter
    for i in range(radius,len(curvePad) - radius):
        sumP = 0
        for j in range(i - radius,i + radius + 1):
            sumP += curvePad[j]
        curveRes[i - radius] = sumP / (2 * radius + 1)
    return curveRes



y = [127.500000000000,127.500000000000,127.500000000000,127.500000000000,127.500000000000,127.500000000000,127.500000000000,127.500000000000,127.500000000000,127.500000000000,127.500000000000,127.500000000000,127.500000000000,127.500000000000,127.500000000000,127.500000000000,127.500000000000,127.500000000000,127.500000000000,127.500000000000,127.500000000000,127.500000000000,127.500000000000,127.500000000000,127.500000000000,127.500000000000,127.500000000000,127.500000000000,127.500000000000,174.385341394092,210.079013491953,228.192442223368,229.500000000000,220.758598062853,210.806450972058,206.155127996082,208.396260404736,214.563524821951,219.862889920765,220.930682521041,217.688474745956,212.901255953750,210.010605461316,210.798019100407,214.377693043293,218.037496220492,219.219814242893,217.250258308311,213.682609096689,211.110447353755,211.324565921011,214.094930267194,217.387599350697,218.829593219018,217.387599350697,214.094930267194,211.324565921011,211.110447353755,213.682609096689,217.250258308312,219.219814242893,218.037496220492,214.377693043293,210.798019100407,210.010605461316,212.901255953750,217.688474745956,220.930682521041,219.862889920765,214.563524821951,208.396260404736,206.155127996082,210.806450972058,220.758598062853,229.500000000000,228.192442223368,210.079013491953,174.385341394092,127.500000000000,80.6146586059078,44.9209865080476,26.8075577766320,25.5000000000001,34.2414019371467,44.1935490279422,48.8448720039184,46.6037395952645,40.4364751780491,35.1371100792348,34.0693174789595,37.3115252540440,42.0987440462497,44.9893945386843,44.2019808995928,40.6223069567067,36.9625037795079,35.7801857571074,37.7497416916888,41.3173909033108,43.8895526462451,43.6754340789891,40.9050697328060,37.6124006493028,36.1704067809825,37.6124006493029,40.9050697328061,43.6754340789893,43.8895526462451,41.3173909033106,37.7497416916885,35.7801857571073,36.9625037795079,40.6223069567068,44.2019808995931,44.9893945386844,42.0987440462498,37.3115252540440,34.0693174789595,35.1371100792347,40.4364751780490,46.6037395952645,48.8448720039185,44.1935490279423,34.2414019371467,25.5000000000002,26.8075577766320,44.9209865080474,80.6146586059076,127.500000000000,174.385341394092,210.079013491953,228.192442223368,229.500000000000,220.758598062854,210.806450972058,206.155127996082,208.396260404736,214.563524821951,219.862889920765,220.930682521040,217.688474745956,212.901255953751,210.010605461316,210.798019100407,214.377693043293,218.037496220492,219.219814242893,217.250258308311,213.682609096689,211.110447353755,211.324565921011,214.094930267194,217.387599350697,218.829593219018,217.387599350697,214.094930267194,211.324565921011,211.110447353755,213.682609096689,217.250258308312,219.219814242893,218.037496220492,214.377693043293,210.798019100407,210.010605461316,212.901255953750,217.688474745956,220.930682521041,219.862889920766,214.563524821951,208.396260404736,206.155127996082,210.806450972058,220.758598062853,229.500000000000,228.192442223368,210.079013491953,174.385341394093,127.500000000000,80.6146586059082,44.9209865080478,26.8075577766320,25.5000000000001,34.2414019371467,44.1935490279421,48.8448720039182,46.6037395952642,40.4364751780495,35.1371100792348,34.0693174789598,37.3115252540441,42.0987440462495,44.9893945386844,44.2019808995927,40.6223069567069,36.9625037795081,35.7801857571076,37.7497416916886,41.3173909033108,43.8895526462451,43.6754340789889,40.9050697328056,37.6124006493026,36.1704067809825,37.6124006493030,40.9050697328064,43.6754340789893,43.8895526462452,41.3173909033106,37.7497416916883,35.7801857571074,36.9625037795079,40.6223069567068,44.2019808995931,44.9893945386845,42.0987440462499,37.3115252540440,34.0693174789593,35.1371100792347,40.4364751780489,46.6037395952643,48.8448720039183,44.1935490279427,34.2414019371470,25.5000000000000,26.8075577766319,44.9209865080474,80.6146586059073,127.500000000000,127.500000000000,127.500000000000,127.500000000000,127.500000000000,127.500000000000,127.500000000000,127.500000000000,127.500000000000,127.500000000000,127.500000000000,127.500000000000,127.500000000000,127.500000000000,127.500000000000,127.500000000000,127.500000000000,127.500000000000,127.500000000000,127.500000000000,127.500000000000,127.500000000000,127.500000000000,127.500000000000,127.500000000000,127.500000000000,127.500000000000,127.500000000000];
yF = meanFilter(y,3)
yE = y + 3 * (y - yF)
#plot
index = [i for i in range(len(y))]
plt.figure()
plt.plot(index,y,label = "yin")
plt.plot(index,yF,label = "filter")
plt.plot(index,yE,label = "yout")
plt.legend()
plt.show()
